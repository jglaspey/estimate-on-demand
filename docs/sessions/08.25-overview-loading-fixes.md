# Overview Page Loading Experience Fixes

## Date: 2025-01-19

### Summary
Fixed the loading experience on the job overview page to show proper skeleton loaders and progress indicators instead of displaying zeros or empty values while data is loading.

## Changes Made

### 1. Created Skeleton Field Components
- **File**: `components/ui/skeleton-field.tsx`
- Created `SkeletonField` component that shows animated skeleton loaders when values are not yet available
- Created `SkeletonCurrency` component specifically for currency values
- These components automatically detect when a value is loading based on:
  - Value is undefined, null, empty string
  - Value is 0 or "$0" (which indicates loading state, not actual zero values)
  - Explicit `loading` prop

### 2. Updated OverviewPage Component
- **File**: `components/OverviewPage.tsx`
- Replaced all field displays with `SkeletonField` components:
  - Insurance carrier
  - Claim rep
  - Estimator
  - Claim number
  - Policy number
  - Date of loss
  - Original estimate
  - Potential supplement
  - Total value
- Added progress percentage display to the "Start Review" button
- Button now shows:
  - Spinner icon when processing
  - Progress percentage (e.g., "Processing (40%)")
  - Remains disabled until ANALYSIS_READY status

### 3. Added Progress Tracking
- **File**: `app/job/[jobId]/page.tsx`
- Added `jobProgress` state to track processing progress
- Added useEffect to poll `/api/jobs/[jobId]/status` endpoint every 1.5 seconds when job is processing
- Progress is fetched only when job status is in ['uploading', 'extracting', 'analyzing']
- Progress is passed to OverviewPage component

## How It Works

### Loading States
1. **Initial Upload**: All fields show skeleton loaders
2. **Phase 1 Extraction** (~5-10s): Priority fields update with actual values
3. **Phase 2 Processing**: Additional fields populate as they become available
4. **Analysis Ready**: All fields show actual values, button becomes enabled

### Progress Indicator
- The `/api/jobs/[jobId]/status` endpoint returns progress based on job status:
  - UPLOADED: 10%
  - QUEUED: 20%
  - PROCESSING: 40%
  - TEXT_EXTRACTED: 70%
  - ANALYSIS_READY: 100%
- Progress is displayed in the button: "Processing (40%)"

### Field Loading Logic
- Fields that are still loading (undefined, null, 0, empty) show skeleton loaders
- Once a field has a real value, it displays immediately
- This creates a progressive loading experience where information appears as it becomes available

## Benefits
1. **No More $0 Values**: Users never see "$0" for fields that are still loading
2. **Clear Progress**: Users can see exact processing progress
3. **Progressive Enhancement**: Information appears as soon as it's available
4. **Better UX**: Clear visual feedback that the system is working

## Testing Notes
- Test with new uploads to see the progressive loading
- Verify that skeleton loaders appear for missing fields
- Confirm progress percentage updates in the button
- Ensure button remains disabled until status is ANALYSIS_READY
